import 'dart:math';

import 'dart:math';

import 'dart:math';

String getColorNameFromRgb(String rgb) {
  // RGB renk adı haritası - çok genişletilmiş
  Map<String, String> colorMap = {
    '255,0,0': 'Kırmızı',
    '255,165,0': 'Turuncu',
    '255,255,0': 'Sarı',
    '0,255,0': 'Yeşil',
    '0,0,255': 'Mavi',
    '75,0,130': 'Mors',
    '238,130,238': 'Orkide',
    '0,255,255': 'Açık Mavi',
    '255,192,203': 'Pembe',
    '128,0,0': 'Bordo',
    '0,0,0': 'Siyah',
    '255,255,255': 'Beyaz',
    '0,0,128': 'Lacivert',
    '255,20,147': 'Fuşya',
    '144,238,144': 'Açık Yeşil',
    '255,105,180': 'Pembe Koyu',
    '255,140,0': 'Koyu Turuncu',
    '173,216,230': 'Açık Mavi',
    '128,128,0': 'Zeytin',
    '192,192,192': 'Gri',
    '128,128,128': 'Gri Koyu',
    '255,99,71': 'Domates',
    '0,255,127': 'Turkuaz',
    '70,130,180': 'Çelik Mavi',
    '218,165,32': 'Altın Sarısı',
    '255,215,0': 'Altın',
    '210,105,30': 'Kestane',
    '106,90,205': 'SlateBlue',
    '255,69,0': 'Kızıl',
    '102,205,170': 'Aquamarine',
    '0,128,128': 'Teal',
    '0,139,139': 'Koyu Teal',
    '255,228,196': 'Çikolata',
    '32,178,170': 'Deniz Yeşili',
    '119,136,153': 'SlateGrey',
    '255,255,224': 'Açık Sarı',
    '240,128,128': 'Koyu Pembe',
    '0,191,255': 'Açık Deniz',
    '255,127,80': 'Kumral',
    '255,240,245': 'Lavanta Pembe',
    '128,64,64': 'Koyu Kahverengi',
    '0,250,154': 'Yeşil Sarmaşık',
    '50,205,50': 'Yeşil',
    '255,0,255': 'Fuşya',
    '148,0,211': 'Derin Mor',
    '240,248,255': 'Açık Mavi',
    '255,182,193': 'LightPink',
    '250,240,230': 'Çimen',
    '245,255,250': 'Mint Yeşili',
    '255,223,186': 'Açık Altın',
    '186,85,211': 'Orkide',
    '255,218,185': 'Peach Puff',
    '143,188,143': 'Hafif Yeşil',
    '245,245,245': 'Beyaz-Gri',
    '255,240,245': 'Lavanta Pembe',
    '199,21,133': 'Fuşya',
    '123,104,238': 'SlateBlue',
    '255,222,173': 'Açık Kumral',
    '169,169,169': 'Gri Koyu',
    '192,255,62': 'Zeytin Yeşili',
    '216,191,216': 'Lavanta',
    '255,182,193': 'Ilıman Pembe',
    '255,69,0': 'Kızıl',
    '255,228,196': 'Bağdat Sarısı',
    '128,128,0': 'Zeytin',
    '128,0,128': 'Mor',
    '0,255,255': 'Açık Turkuaz',
    '135,206,250': 'Açık Mavi',
    // Ek renkler
    '255,240,245': 'Pembe Lavanta',
    '144,238,144': 'Yeşil Açık',
    '128,128,128': 'Koyu Gri',
    '255,223,186': 'Altın Açık',
    '105,105,105': 'Koyu Gri',
    // Yeni eklenen renkler:
    '242,242,242': 'Kırık Beyaz',
    '248,248,255': 'Hayalet Beyaz',
    '245,245,245': 'Beyaz Duman',
    '220,220,220': 'Gainsboro Beyazı',
    '255,255,255': 'Beyaz',
    '0,0,0': 'Siyah',
    '128,128,128': 'Orta Gri',
    '144,143,143': 'Orta Gri 2',
    '102,102,102': 'Koyu Gri',
    '95,95,95': 'Koyu Gri 2',
    '105,105,105': 'Bulanık Gri',
    '221,221,221': 'Açık Gri',
    '211,211,211': 'Açık Gri 2',
    '190,190,190': 'Gri',
    '28,28,28': 'Gri 11',
    '54,54,54': 'Gri 21',
    '79,79,79': 'Gri 31',
    '105,105,105': 'Gri 41',
    '130,130,130': 'Gri 51',
    '156,156,156': 'Gri 61',
    '181,181,181': 'Gri 71',
    '207,207,207': 'Gri 81',
    '232,232,232': 'Gri 91',
    '169,169,169': 'Koyu Gri',
    '119,136,153': 'Açık Barut Grisi',
    '112,128,144': 'Barut Grisi',
    '198,226,255': 'Barut Grisi 1',
    '185,211,238': 'Barut Grisi 2',
    '159,182,205': 'Barut Grisi 3',
    '108,123,139': 'Barut Grisi 4',
    '47,79,79': 'Koyu Barut Grisi',
    '151,255,255': 'Koyu Barut Grisi 1',
    '141,238,238': 'Koyu Barut Grisi 2',
    '121,205,205': 'Koyu Barut Grisi 3',
    '82,139,139': 'Koyu Barut Grisi 4',
    '74,128,77': 'Grimsi Yeşil',
    '111,128,74': 'Grayish Spring Bud',
    '139,101,139': 'Grayish Magenta',
    '238,232,170': 'Pale Golden Rod',
    '255,250,240': 'Floral White',
    '250,250,210': 'Light Golden Rod Yellow',
    '139,69,19': 'Saddle Brown',
    '160,82,45': 'Sienna',
    '253,245,230': 'Old Lace',
    '250,240,230': 'Linen',
    '255,239,213': 'Papaya Whip',
    '255,235,205': 'Blanched Almond',
    '255,228,181': 'Moccasin',
    '205,133,63': 'Peru',
    '245,245,220': 'Beige',
    '244,164,96': 'Sandy Brown',
    '255,250,250': 'Snow 1',
    '238,233,233': 'Snow2',
    '205,201,201': 'Snow3',
    '139,137,137': 'Snow4',
    '255,245,238': 'Seashell 1',
    '238,229,222': 'Seashell2',
    '205,197,191': 'Seashell3',
    '139,134,130': 'Seashell4',
    '250,235,215': 'Antique White',
    '255,239,219': 'AntiqueWhite1',
    '238,223,204': 'AntiqueWhite2',
    '205,192,176': 'AntiqueWhite3',
    '139,131,120': 'AntiqueWhite4',
    '255,228,196': 'Bisque 1',
    '238,213,183': 'Bisque2',
    '205,183,158': 'Bisque3',
    '139,125,107': 'Bisque4',
    '255,218,185': 'Peach Puff 1',
    '238,203,173': 'PeachPuff2',
    '205,175,149': 'PeachPuff3',
    '139,119,101': 'PeachPuff4',
    '180,205,205': 'LightCyan3',
    '122,139,139': 'LightCyan4',
    '95,158,160': 'Cadet Blue',
    '152,245,255': 'CadetBlue1',
    '142,229,238': 'CadetBlue2',
    '122,197,205': 'CadetBlue3',
    '83,134,139': 'CadetBlue4',
    '175,238,238': 'Pale Turquoise',
    '187,255,255': 'PaleTurquoise1',
    '174,238,238': 'PaleTurquoise2',
    '150,205,205': 'PaleTurquoise3',
    '102,139,139': 'PaleTurquoise4',
    '72,209,204': 'Medium Turquoise',
    '0,206,209': 'Dark Turquoise',
    '64,224,208': 'Turquoise',
    '0,245,255': 'Turquoise1',
    '0,229,238': 'Turquoise2',
    '0,197,205': 'Turquoise3',
    '0,134,139': 'Turquoise4',
    '0,255,255': 'Cyan1',
    '0,238,238': 'Cyan2',
    '0,205,205': 'Cyan3',
    '0,139,139': 'Dark Cyan',
    '28,96,113': 'Dark Cerulean',
    '127,255,212': 'Aquamarine 1',
    '118,238,198': 'Aquamarine2',
    '102,205,170': 'Aquamarine3',
    '69,139,116': 'Aquamarine4',
    '143,188,143': 'Dark Sea Green',
    '193,255,193': 'Dark Sea Green 1',
    '180,238,180': 'Dark Sea Green 2',
    '155,205,155': 'Dark Sea Green 3',
    '105,139,105': 'Dark Sea Green 4',
    '46,139,87': 'Sea Green',
    '84,255,159': 'SeaGreen1',
    '78,238,148': 'SeaGreen2',
    '67,205,128': 'SeaGreen3',
    '152,251,152': 'Pale Green',
    '154,255,154': 'PaleGreen1',
    '144,238,144': 'PaleGreen2',
    '124,205,124': 'PaleGreen3',
    '84,139,84': 'PaleGreen4',
    '0,255,127': 'Spring Green1',
    '0,238,118': 'SpringGreen2',
    '0,205,102': 'SpringGreen3',
    '0,139,69': 'SpringGreen4',
    '0,255,0': 'Green 1',
    '0,238,0': 'Green2',
    '0,205,0': 'Green3',
    '0,139,0': 'Green4',
    '0,100,0': 'Dark Green',
    '75,161,35': 'Moderate Pistachio',
    '60,179,113': 'Medium Sea Green',
    '32,178,170': 'Light Sea Green',
    '144,238,144': 'Light Green',
    '124,252,0': 'Lawn Green',
    '0,250,154': 'Medium Spring Green',
    '173,255,47': 'Green Yellow',
    '50,205,50': 'Lime',
    '154,205,50': 'Yellow Green',
    '34,139,34': 'Forest Green',
    '127,255,0': 'Chartreuse 1',
    '118,238,0': 'Chartreuse2',
    '102,205,0': 'Chartreuse3',
    '69,139,0': 'Chartreuse 4',
    '107,142,35': 'Olive Drab',
    '192,255,62': 'Olive Drab 1',
    '179,238,58': 'OliveDrab2',
    '154,205,50': 'OliveDrab3',
    '105,139,34': 'OliveDrab4',
    '85,107,47': 'Dark Olive Green',
    '202,255,112': 'DarkOliveGreen1',
    '188,238,104': 'DarkOliveGreen2',
    '162,205,90': 'DarkOliveGreen3',
    '110,139,61': 'DarkOliveGreen4',
    '255,246,143': 'Khaki 1',
    '238,230,133': 'Khaki2',
    '205,198,115': 'Khaki3',
    '139,134,78': 'Khaki4',
    '189,183,107': 'Dark Khaki',
    '238,221,130': 'Light Golden Rod',
    '255,236,139': 'LightGoldenrod1',
    '238,220,130': 'LightGoldenrod2',
    '205,190,112': 'LightGoldenrod3',
    '139,129,76': 'LightGoldenrod4',
    '255,255,224': 'Light Yellow 1',
    '238,238,209': 'LightYellow2',
    '205,205,180': 'LightYellow3',
    '139,139,122': 'LightYellow4',
    '255,255,0': 'Yellow 1',
    '238,238,0': 'Yellow2',
    '205,205,0': 'Yellow3',
    '139,139,0': 'Yellow4',
    '255,192,0': 'Luminous Vivid Amber',
    '255,215,0': 'Gold1',
    '238,201,0': 'Gold2',
    '205,173,0': 'Gold3',
    '139,117,0': 'Gold4',
    '255,228,19': 'Light Brilliant Gold',
    '218,165,32': 'Golden Rod',
    '255,193,37': 'Goldenrod1',
    '238,180,34': 'Goldenrod2',
    '205,155,29': 'Goldenrod3',
    '139,105,20': 'Goldenrod4',
    '184,134,11': 'Dark Golden Rod',
    '255,185,15': 'DarkGoldenrod1',
    '238,173,14': 'DarkGoldenrod2',
    '205,149,12': 'DarkGoldenrod3',
    '188,143,143': 'Rosy Brown',
    '255,193,193': 'RosyBrown1',
    '238,180,180': 'RosyBrown2',
    '205,155,155': 'RosyBrown3',
    '139,105,105': 'RosyBrown4',
    '205,92,92': 'Indian Red',
    '255,106,106': 'IndianRed1',
    '238,99,99': 'IndianRed2',
    '205,85,85': 'IndianRed3',
    '139,58,58': 'IndianRed4',
    '255,130,71': 'Sienna 1',
    '238,121,66': 'Sienna2',
    '205,104,57': 'Sienna3',
    '139,71,38': 'Sienna4',
    '222,184,135': 'Burly Wood',
    '255,211,155': 'Burlywood1',
    '238,197,145': 'Burlywood2',
    '205,170,125': 'Burlywood3',
    '139,115,85': 'Burlywood4',
    '245,222,179': 'Wheat',
    '255,231,186': 'Wheat1',
    '238,216,174': 'Wheat2',
    '205,186,150': 'Wheat3',
    '139,126,102': 'Wheat4',
    '210,180,140': 'Tan',
    '255,165,79': 'Tan1',
    '238,154,73': 'Tan2',
    '205,133,63': 'Tan3',
    '139,90,43': 'Tan4',
    '210,105,30': 'Chocolate',
    '255,127,36': 'Chocolate1',
    '238,118,33': 'Chocolate2',
    '205,102,29': 'Chocolate3',
    '139,69,19': 'Chocolate4',
    '178,34,34': 'Fire Brick',
    '255,48,48': 'Firebrick1',
    '238,44,44': 'Firebrick2',
    '205,38,38': 'Firebrick3',
    '139,26,26': 'Firebrick4',
    '165,42,42': 'Brown',
    '255,64,64': 'Brown1',
    '238,59,59': 'Brown2',
    '205,51,51': 'Brown3',
    '139,35,35': 'Brown4',
    '250,128,114': 'Salmon',
    '255,140,105': 'Salmon1',
    '238,130,98': 'Salmon2',
    '205,112,84': 'Salmon3',
    '139,76,57': 'Salmon4',
    '255,160,122': 'Light Salmon 1',
    '238,149,114': 'LightSalmon2',
    '205,129,98': 'LightSalmon3',
    '139,87,66': 'LightSalmon4',
    '255,165,0': 'Orange 1',
    '238,154,0': 'Orange2',
    '205,133,0': 'Orange3',
    '139,90,0': 'Orange4',
    '238,126,21': 'Brilliant Orange',
    '255,140,0': 'Dark Orange',
    '255,127,0': 'DarkOrange1',
    '238,118,0': 'DarkOrange2',
    '205,102,0': 'DarkOrange3',
    '139,69,0': 'DarkOrange4',
    '240,128,128': 'Light Coral',
    '255,127,80': 'Coral',
    '255,114,86': 'Coral1',
    '238,106,80': 'Coral2',
    '205,91,69': 'Coral3',
    '139,62,47': 'Coral4',
    '255,99,71': 'Tomato 1',
    '238,92,66': 'Tomato2',
    '205,79,57': 'Tomato3',
    '139,54,38': 'Tomato4',
    '255,69,0': 'Orange Red 1',
    '238,64,0': 'OrangeRed2',
    '205,55,0': 'OrangeRed3',
    '204,90,17': 'Moderate Tangelo',
    '255,0,0': 'Red1',
    '238,0,0': 'Red2',
    '205,0,0': 'Red3',
    '164,0,0': 'Dark Candy Apple Red',
    '139,0,0': 'Dark Red',
    '198,0,0': 'Rouge',
    '220,20,60': 'Crimson',
    '255,20,147': 'Deep Pink 1',
    '238,18,137': 'DeepPink2',
    '205,16,118': 'DeepPink3',
    '139,10,80': 'DeepPink4',
    '139,28,98': 'Maroon4',
    '208,32,144': 'Violet Red',
    '255,62,150': 'VioletRed1',
    '238,58,140': 'VioletRed2',
    '205,50,120': 'VioletRed3',
    '139,34,82': 'VioletRed4',
    '255,0,255': 'Magenta1',
    '238,0,238': 'Magenta2',
    '205,0,205': 'Magenta3',
    '139,0,139': 'Dark Magenta',
    '218,112,214': 'Orchid',
    '255,131,250': 'Orchid1',
    '238,122,233': 'Orchid2',
    '205,105,201': 'Orchid3',
    '139,71,137': 'Orchid4',
    '221,160,221': 'Plum',
    '255,187,255': 'Plum1',
    '238,174,238': 'Plum2',
    '205,150,205': 'Plum3',
    '139,102,139': 'Plum4',
    '186,85,211': 'Medium Orchid',
    '224,102,255': 'MediumOrchid1',
    '209,95,238': 'MediumOrchid2',
    '180,82,205': 'MediumOrchid3',
    '122,55,139': 'MediumOrchid4',
    '153,50,204': 'Dark Orchid',
    '191,62,255': 'DarkOrchid1',
    '178,58,238': 'DarkOrchid2',
    '154,50,205': 'DarkOrchid3',
    '104,34,139': 'DarkOrchid4',
    '199,21,133': 'Medium Violet Red',
    '238,130,238': 'Violet',
    '148,0,211': 'Dark Violet',
    '138,43,226': 'Blue Violet',
    '128,0,128': 'Purple',
    '160,32,240': 'Purple1',
    '155,48,255': 'Purple2',
    '145,44,238': 'Purple3',
    '125,38,205': 'Purple4',
    '85,26,139': 'Purple5',
    '147,112,219': 'Medium Purple',
    '171,130,255': 'MediumPurple1',
    '159,121,238': 'MediumPurple2',
    '137,104,205': 'MediumPurple3',
    '93,71,139': 'MediumPurple4',
    '216,191,216': 'Thistle',
    '255,225,255': 'Thistle1',
    '238,210,238': 'Thistle2',
    '205,181,205': 'Thistle3',
    '139,123,139': 'Thistle4',
    '221,196,136': 'Antique Gold',
    '255,222,102': 'Cream',
    '236,171,83': 'Aged Paper',
    '192,192,192': 'Silver',
    '0,128,128': 'Teal',
    '255,204,153': 'Blush',
  };

  // Gelen RGB verisini işleyelim
  rgb = processRgbString(rgb); // Veriyi düzgün formata çevir

  if (rgb.isEmpty) {
    return 'Geçersiz RGB Değeri'; // Geçersiz format durumu
  }

  List<int> inputRgb = rgb.split(',').map((e) => int.parse(e.trim())).toList();

  String closestColorName = '';
  double closestDistance = double.infinity;

  // En yakın rengi bulma algoritması (daha hassas mesafe)
  colorMap.forEach((key, name) {
    List<int> mapRgb = key.split(',').map((e) => int.parse(e)).toList();

    // Geliştirilmiş Euclidean mesafesi hesaplama (daha hassas)
    double distance = _calculateColorDistance(inputRgb, mapRgb);

    // En yakın rengi bul
    if (distance < closestDistance) {
      closestDistance = distance;
      closestColorName = name;
    }
  });

  // En yakın rengi döndür
  return closestColorName;
}




// Renk mesafesini daha hassas şekilde hesaplayan fonksiyon
double _calculateColorDistance(List<int> inputRgb, List<int> mapRgb) {
  double distance = 0;
  // Kırmızı, Yeşil ve Mavi bileşenleri arasındaki farkların karelerinin toplamı
  for (int i = 0; i < 3; i++) {
    distance += pow(inputRgb[i] - mapRgb[i], 2);
  }

  // Kökünü alarak Euclidean mesafeyi hesapla
  return sqrt(distance);
}

String processRgbString(String rgb) {
  // "rgb(0, 0, 0)" formatındaki veriyi "0,0,0" formatına dönüştürür
  final match = RegExp(r'rgb\((\d+),\s*(\d+),\s*(\d+)\)').firstMatch(rgb);
  if (match != null) {
    return '${match.group(1)},${match.group(2)},${match.group(3)}';
  } else {
    return ''; // Geçersiz format durumunda boş döndür
  }
}
